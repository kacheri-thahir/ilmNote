{% extends "base.html" %}

{% block content %}

    {% for post in featured_posts %}
        {% if forloop.first %}
        <header class="hero" style="background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.6)), url('{{ post.featured_image.url }}');">
            <div class="hero-content">
                <span class="tag">Featured Story</span>
                <h1>{{ post.title |truncatechars:40 }}</h1>
                <p>{{ post.short_description |truncatewords:10 }}</p>
                <a href="{% url "blogs" post.slug %}" class="read-more">Read Article &rarr;</a>
            </div>
        </header>
        {% endif %}
    {% endfor %}

    <main class="home-container" style="margin-top: 40px;">
        
        <div class="section-header">
            <h2>Featured Posts</h2>
            </div>
        
        <div class="horizontal-scroll-container">
            {% for post in featured_posts|slice:":7" %}
                {% if not forloop.first %} <div class="scroll-card">
                    <div class="card-image">
                        {% if post.featured_image %}
                            <img src="{{ post.featured_image.url }}" alt="{{ post.title }}">
                        {% else %}
                            <img src="{{ MEDIA_URL }}ilmnote_default_image.png" alt="ilmnote_default_image">
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <a href="{% url "blogs" post.slug %}">
                            <h4>{{ post.title|truncatechars:40 }}</h4>
                        </a>
                        <p>{{ post.short_description|truncatewords:10 }}</p>
                        
                        <div class="card-footer" style="margin-top: 10px; font-size: 0.8rem; color: #888;">
                            <span>{{ post.author }}</span> 
                            <span>{{ post.created_at|timesince }} ago</span>
                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        </div>


        <div class="section-header" style="margin-top: 50px;">
            <h2>Recent Articles</h2>
            <div class="divider"></div>
        </div>

        <div class="horizontal-scroll-container">
            {% for post in posts|slice:":7" %}
            <div class="scroll-card">
                <div class="card-image">
                    {% if post.featured_image %}
                        <img src="{{ post.featured_image.url }}" alt="{{ post.title }}">
                    {% else %}
                        <img src="{{ MEDIA_URL }}ilmnote_default_image.png" alt="ilmnote_default_image">  <!-- Default image if no image uploaded -->
                    {% endif %}
                </div>
                
                <div class="card-content">
                    <a href="{% url "blogs" post.slug %}">
                        <h4>{{ post.title|truncatechars:40 }}</h4>
                    </a>
                    <p>{{ post.short_description|truncatewords:10 }}</p>

                    <div class="card-footer" style="margin-top: 10px; font-size: 0.8rem; color: #888;">
                        <span>{{ post.author }}</span> 
                        <span>{{ post.created_at|timesince }} ago</span>
                    </div>
                </div>
            </div>
            {% empty %}
                <p>No recent posts available.</p>
            {% endfor %}
        </div>

    </main>

{% endblock %}